# Extracts IPs, ports, and actions from MikroTik logs for Kibana. (needs work)

filter {
  if [program] == "mikrotik" {
    grok {
      match => { "message" => "%{GREEDYDATA:rawlog}" }
    }
    mutate {
      add_field => { "source_ip" => "%{[rawlog][src-address]}" }
      add_field => { "destination_ip" => "%{[rawlog][dst-address]}" }
      add_field => { "port" => "%{[rawlog][dst-port]}" }
    }
  }
}


# Create Visualisation in Kibana
Port Scan Detection (PORT-SCAN DETECTED)
Show most scanned ports and attacking IPs.

Honeypot Hits (HONEYPOT HIT)
Identify targeted SSH/RDP brute-force attempts.

Blacklisted IPs (Artillery, PSD)
Track how many threats were blocked per hour/day.


# Suricata Implementation example
#MUST RUN IN IPS!!

alert tcp any any -> $HOME_NET any (msg:"[SURICATA] MikroTik Port Scan Detected"; sid:100001; rev:1; content:"PORT-SCAN DETECTED";)
alert tcp any any -> $HOME_NET any (msg:"[SURICATA] Honeypot Attack Detected"; sid:100002; rev:1; content:"HONEYPOT HIT";)
alert ip any any -> $HOME_NET any (msg:"[SURICATA] MikroTik Blacklist Hit"; sid:100003; rev:1; content:"BLACKLISTED INPUT";)
